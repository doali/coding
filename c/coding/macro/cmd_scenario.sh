#!/usr/bin/env bash

# ------------------------------------------------------------------------------
# (0) : clean
# ------------------------------------------------------------------------------
./cmd_clean

# ------------------------------------------------------------------------------
# (1) : [preprocessor] => .i
# ------------------------------------------------------------------------------
cpp macro.c >macro.i

# ------------------------------------------------------------------------------
# (2) : assemblee code => .s
# ------------------------------------------------------------------------------
gcc -S macro.i 

# ------------------------------------------------------------------------------
# (3) : object code => .o
as -o macro.o macro.s 
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# INFO : interface with nm
# ------------------------------------------------------------------------------
#nm macro.o 
#nm -a macro.o 

# ------------------------------------------------------------------------------
# INFO : interface with readelf
# ------------------------------------------------------------------------------
readelf -s macro.o
#readelf -a macro.o

# ------------------------------------------------------------------------------
# (4) : linked (ld) => .exe
# ------------------------------------------------------------------------------
gcc -o macro.exe macro.o 

# ------------------------------------------------------------------------------
# INFO : dependencies
# ------------------------------------------------------------------------------
#ldd macro.o
ldd macro.exe

# ------------------------------------------------------------------------------
# RUN
# ------------------------------------------------------------------------------
#./macro 
